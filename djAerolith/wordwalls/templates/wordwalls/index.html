{% extends "base.html" %}

{% load assets %}

{% block ss %}
{% assets "css_table_create" %}
    <link href="{{ ASSET_URL }}" rel="stylesheet" type="text/css">
{% endassets %}

{% assets "base_css" %}
    <link href="{{ ASSET_URL }}" rel="stylesheet" type="text/css">
{% endassets %}

{% endblock %}
{% block title %}Wordwalls - select list{% endblock %}

{% block content %}

{% assets "js_table_create" %}
    <script type="text/javascript" src="{{ ASSET_URL }}"></script>
{% endassets %}

<P></P>
<div id="commonForm">
    {{lexForm.as_p}}
    {{timeForm.as_p}}
</div>
What type of list do you want?
<div id="listTabs">
    <ul>
        <li><a href="#tabs-1">Today's Challenges</a></li>
        <li><a href="#tabs-2">Search by probability</a></li>
        <li><a href="#tabs-3">Saved List</a></li>
        <li><a href="#tabs-4">Named List</a></li>        
    </ul>
    <div id="tabs-1">
        <div id="showChallengesHelp" class="showHelp">
        Click for help
        </div>
        
        <div id="challengesHelp" class="help">
        <P>Hooooooold. Challenge. A new set of challenges is generated once a day. To play the challenges, select the lexicon and challenge, and click Play! You can also see how other people did today on the display to the right of the challenge.</P>
        <P>The "Week's Bingo Toughies" list gets updated every Tuesday at midnight PST (i.e. Tuesday 3AM EST). It will have the 50 toughest bingo alphagrams (7 and 8 letter words) of all of the previous week's challenges. The toughest bingos are the ones most commonly missed that week.</P>
        </div>
        <table id="challengesLayout"> 
        <tr>
            <td id="dcFormCell">
                {{ dcForm.as_p}}
                <button class="formSubmitButton" id="challengeSubmit">Play!</button>
            </td>
            <td id="dcResultsCell">
                <span id="dcResultsLabel"></span><BR>
                <div id="dcResultsDiv"></div>
            </td>
        </tr>
        </table>
        
    </div>

    <div id="tabs-2">
        <div id="showSearchParamsHelp" class="showHelp">
        Click for help
        </div>

        <div id="searchParamsHelp" class="help">
        <P>Here, you can search word lists by probability (and possibly other parameters in the future). Simply select a lexicon and a word length. The minimum probability must always be greater than or equal 1; the maximum probability must be less than or equal to the number of words with that word length -- this number will show up in the "Max probability" label below. In the future, you'll also be able to select multiplayer modes.</P>
        <P>The probabilities are alphagram probabilities, and not word probabilities.</P>
        </div>
        
        {{ fwForm.as_p }}
        <button class="formSubmitButton" id="searchParamsSubmit">Play!</button>
    </div>

    <div id ="tabs-3">
        <div id="showSavedListHelp" class="showHelp">
        Click for help
        </div>

        <div id="savedListHelp" class="help">
            <H3>Playing a saved list</H3>
            <P>First, please select a lexicon to view the saved lists for that lexicon.</P>
            <P>You can select a list that you have previously saved here. When you are playing a game, you have the option to save at the beginning or end of a round by clicking the Save button. Once you do this, the game will autosave after every round you play. When you save you will be prompted for a case-insensitive list name. These saved games show up in the list below. There are four options:</P>
            <H4>Continue list progress (default)</H4>
            <P>This will continue the list from where you last left off.</P>
 
            <H4>Quiz only on first missed</H4>
            <P>The very first time you go through a word list in its entirety, you will have a list of missed words. This quiz will consist only of those missed words. <em>If you select this option, and don't finish the 'first missed' list, if you want to finish it next time make sure to select 'continue list progress.'</em> You will get an error if you select this option before finishing a quiz once.</P>
        
            <H4>Restart list</H4>
            <P>In this option, you will restart the list from scratch. This eliminates progress on the list, so be careful! Your 'first' missed data will be lost.</P>
            <P>The table below that shows your word lists will show the name of the word list, and the last time this list was saved. There will also be an asterisk (*) after the date if you have already gone through the entire word list at least once.</P>
            <H4>Delete list</H4>
            <P>This option completely deletes the list; this cannot be undone! Make sure you want to delete your saved list before you choose this!</P>
            <H3>Uploading a new list</H3>
            <P>You can select the upload button to add a new word list to your account. Please select a file containing a list of words, one word per line. This app will quiz you on alphagrams, so for example, if your list contains DIATRONS but not INTRADOS, the app will still expect both words when it quizzes you for ADINORST. Make sure to select the correct lexicon.</P>
            <P>You can easily export a list from a program such as Zyzzyva; simply do a search, and right click on the search window, and click Save List. The list must contain no more than {{upload_list_limit}} words at this time, and the words must be between 2 and 15 letters long. This limit will probably be increased in the future once I figure out how to use Celery. </P>
        </div>
        <div id="numAlphasInfo"></div>
            {{ slForm.as_p }}
        <span id="savedListWarning"></span>
        
        <button class="formSubmitButton" id="savedListsSubmit">Play!</button>
        <br>
        <H3>Or upload a new list:</H3>

        <div id="file-uploader">       
            <noscript>          
                <p>Please enable JavaScript to use file uploader.</p>
            </noscript>         
        </div>
    </div>

    <div id ="tabs-4">
        <div id="showNamedListHelp" class="showHelp">
        Click for help
        </div>
        <div id="namedListHelp" class="help">
        <P>Help for named lists</P>
        </div>
        <P>
        Form for named lists
        </P>
        <button class="formSubmitButton" id="namedListSubmit">Play!</button>
    </div>
</div>


<script type="text/javascript">
  $(document).ready(function() {

    initializeTableCreatePage("{{lengthCounts|escapejs}}", "{{dcTimes|escapejs}}", "{% url wordwalls_create_table %}");

    var labelSize = '130px';
    $("label[for='id_wordLength']").width(labelSize);
    $("label[for='id_probabilityMin']").width(labelSize);
    $("label[for='id_probabilityMax']").width(labelSize);
    $("label[for='id_quizTime']").width(labelSize);
    $("label[for='id_playerMode']").width(labelSize);
    $("label[for='id_lexicon']").width(labelSize);

    $(".help").hide();
    $(".showHelp").click(function(){
        $(this).next(".help").toggle("slow");
    });
    $(".showHelp").button();

    requestSavedListInfo();
    $("#listTabs").tabs({
                        select: tabSelected,
                        });
    $(".formSubmitButton").button();
    $("#challengeSubmit").click(challengeSubmitClicked);
    $("#searchParamsSubmit").click(searchParamsSubmitClicked);
    $("#savedListsSubmit").click(savedListsSubmitClicked);

    $("#id_quizTime").attr('disabled', true);   // disable time select since daily challenges are selected
 });

var uploader = new qq.FileUploader( {
     action: "{% url ajax_upload %}",
     element: $('#file-uploader')[0],
     multiple: true,
     onComplete: function( id, fileName, responseJSON ) {
       if( responseJSON.success )
         alert( "success!" ) ;
       else
         alert( "upload failed!" ) ;
     },
     onAllComplete: function( uploads ) {
       // uploads is an array of maps
       // the maps look like this: { file: FileObject, response: JSONServerResponse }
       alert( "All complete!" ) ;
     },
     params: {
       'csrf_token': '{{ csrf_token }}',
       'csrf_name': 'csrfmiddlewaretoken',
       'csrf_xname': 'X-CSRFToken',
     },
   });
  
</script>

{% endblock %}

{% comment %} Aerolith 2.0: A web-based word game website
Copyright (C) 2011 Cesar Del Solar
 
This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.
 
This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.
 
You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.

To contact the author, please email delsolar at gmail dot com
{% endcomment %}
